!function(){let e=new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",maximumFractionDigits:0}),t=e=>(100*e).toFixed(2)+"%";function r(e,t,r){if(0===e)return-(r/t);let n=Math.pow(1+e,t);return-(r*e*n)/(n-1)}let n={monthly:12,fortnightly:26,weekly:52},a=e=>e/100/12;function l({amount:e,annualRatePct:t,years:a,frequency:l="monthly",extraPerPeriod:o=0,type:u="pi",ioYears:i=0}){let s=n[l]||12,c=a*s,$=t/100/s,d=e,m=[],p="io"===u?i*s:0,f=0===$?e/c:-r($,c,e);for(let y=1;y<=c;y++){let v=d*$,h=0,x=0;if(p>0?(h=Math.max(0,(x=v+o)-v),p--):h=(x=f+o)-v,d=Math.max(0,d-h),m.push({i:y,interest:v,principal:h,balance:d,pay:x}),d<=0)break}let b=m.reduce((e,t)=>e+t.pay,0),I=m.reduce((e,t)=>e+t.interest,0);return{schedule:m,totalPaid:b,totalInterest:I,perPayment:m.length?m[0].pay:0}}function o(e,t){let r=0;for(let n of t){let a=null==n.max?Number.POSITIVE_INFINITY:n.max;if(e>n.min){let l=Math.min(e,a)-n.over;l>0&&(r=n.base+l*n.rate)}else break}return Math.max(0,r)}function u(e,t){let r=String(Math.max(0,Math.min(6,e)));return t.minimum_monthly_expense_floor[r]??2e3}let i=e=>.03*e;function s({netMonthlyIncome:e,monthlyExpenses:t,otherMonthlyDebts:r,creditCardLimits:n,annualRatePct:a,years:l,bufferPct:o=3}){let u=(a+o)/100/12,s=12*l,c=Math.max(0,e-t-r-i(n));return c<=0?0:0===u?c*s:c*(1-Math.pow(1+u,-s))/u}function c(e,t,n){let l=a(t);return-r(l,12*n,e)}function $(e,t){return e*(t/100/12)}function d({price:e,deposit:t,lmiCapitalised:r=0}){let n=Math.max(0,e-t)+r;return{loan:n,lvr:n<=0||e<=0?0:n/e}}function m({loan:e,lvr:t,lmiTable:r}){if(t<=.8)return 0;for(let n of r.bands)if(t>=n.min_lvr&&t<n.max_lvr)for(let a of n.rates){let l=null==a.max_loan?Number.POSITIVE_INFINITY:a.max_loan;if(e>=a.min_loan&&e<l)return e*a.rate}return 0}function p({price:e,state:t}){if("function"==typeof window.calculateStampDuty)try{return Math.max(0,window.calculateStampDuty(e,t))}catch(r){}if(window.STAMP_DUTY_TABLES&&window.STAMP_DUTY_TABLES[t]){let n=window.STAMP_DUTY_TABLES[t],a=0,l=0;for(let o of n){let u=o.upTo??Number.POSITIVE_INFINITY;if(e>l){let i=Math.min(e,u)-(o.over??l);i>0&&(a=(o.base??a)+i*o.rate),l=u}}return Math.max(0,a)}return 0}let f=e=>document.querySelector(e),y=e=>Array.from(document.querySelectorAll(e));function v(e,t,r,n,a){e&&(e.min=r,e.max=n,e.step=a,e.addEventListener("input",()=>{t.value=e.value})),t&&t.addEventListener("blur",()=>{let a=Math.max(+r,Math.min(+n,+t.value||0));t.value=a,e&&(e.value=a)})}let h={bp:"hlm_bp_inputs",rp:"hlm_rp_inputs"};async function x(){let r=f("#bp-form");if(!r)return;let n=f("#incomeSlider"),a=f("#incomeInput"),l=f("#expensesSlider"),i=f("#expensesInput"),x=f("#dependants"),b=f("#otherDebtsSlider"),I=f("#otherDebts"),S=f("#rateSlider"),_=f("#rate"),E=f("#term");!function e(t){if(t){t.innerHTML="";for(let r=1;r<=30;r++){let n=document.createElement("option");n.value=String(r),n.textContent=String(r),t.appendChild(n)}t.value="30"}}(E);let L=f("#propertyPrice"),A=f("#deposit"),T=f("#state"),P=f("#capitaliseLMI"),q=f("#rememberInputs"),k=f("#recalculateBtn");y(".info-btn").forEach(e=>{let t=e.getAttribute("aria-controls");t&&function e(t,r){let n=document.getElementById(r);n&&t.addEventListener("click",()=>{let e="true"===n.getAttribute("data-open");n.setAttribute("data-open",String(!e)),t.setAttribute("aria-expanded",String(!e))})}(e,t)}),v(n,a,0,3e5,1e3),v(l,i,0,2e4,50),v(b,I,0,1e4,50),v(S,_,0,10,.01);let[C,D,g,M]=await Promise.all([fetch("/assets/au_tax_bands_2025_2026.json").then(e=>e.json()),fetch("/assets/dependants_cost_table.json").then(e=>e.json()),fetch("/assets/lmi_table.json").then(e=>e.json()),fetch("/assets/stampDuty.json").then(e=>e.json())]);window.STAMP_DUTY_TABLES=function e(t){if(!t)return{};let r=t.jurisdictions||t.states||t||{},n={};for(let[a,l]of Object.entries(r)){let o=Array.isArray(l)?l:l&&(l.bands||l.non_ppr_bands||l.ppr_bands||l.rates||[])||[],u=o.map(e=>{let t=e.over??e.min??0,r=e.upTo??e.max;null==r&&(r=Number.POSITIVE_INFINITY);let n=e.rate;null==n&&"number"==typeof e.percent&&(n=e.percent/100),null==n&&"number"==typeof e.per_100&&(n=e.per_100/100);let a="number"==typeof e.base?e.base:0;return"number"==typeof e.duty?{over:t,upTo:r,base:e.duty,rate:0}:{over:t,upTo:r,base:a,rate:n??0}});u.sort((e,t)=>e.over-t.over),n[a]=u}return n}(M),P.checked=!!g.capitalise_by_default;let Y=function e(t,r){try{let n=localStorage.getItem(t);if(!n)return null;let a=JSON.parse(n);return r&&(r.checked=!0),a}catch{return null}}(h.bp,q);Y&&(Object.entries(Y).forEach(([e,t])=>{let r=f("#"+e);r&&("checkbox"===r.type?r.checked=!!t:r.value=t)}),n&&(n.value=a.value),l&&(l.value=i.value),b&&(b.value=I.value),S&&(S.value=_.value));let B={maxLoanBuffered:f("#maxLoanBuffered"),maxLoanActual:f("#maxLoanActual"),monthlyPI:f("#monthlyPI"),monthlyIO:f("#monthlyIO"),lvr:f("#lvr"),lmi:f("#lmi"),stampDuty:f("#stampDuty")};function j(){var r,n,f;let y=+a.value||0,v=o(y,C.brackets),b=(y-v)/12,S=parseInt(x.value||"0",10),k=u(S,D),M=Math.max(k,+i.value||0);b>0&&M>b&&(M=b,i.value=String(Math.round(M)),l&&(l.value=i.value));let Y=+I.value||0,j=parseFloat(parseFloat(_.value).toFixed(2)),N=parseInt(E.value,10),F=+L.value||0,w=+A.value||0,R=s({netMonthlyIncome:b,monthlyExpenses:M,otherMonthlyDebts:Y,creditCardLimits:0,annualRatePct:j,years:N,bufferPct:3}),O=s({netMonthlyIncome:b,monthlyExpenses:M,otherMonthlyDebts:Y,creditCardLimits:0,annualRatePct:j,years:N,bufferPct:0}),U=d({price:F,deposit:w,lmiCapitalised:0}),V=m({loan:U.loan,lvr:U.lvr,lmiTable:g});if(P.checked&&V>0){let H=d({price:F,deposit:w,lmiCapitalised:V}),z=H.lvr,G=m({loan:H.loan,lvr:z,lmiTable:g});V=G}let J=p({price:F,state:T.value}),K=c(O,j,N),Q=$(O,j);B.maxLoanBuffered.textContent=R?e.format(Math.round(R)):"—",B.maxLoanActual.textContent=O?e.format(Math.round(O)):"—",B.monthlyPI.textContent=K?e.format(Math.round(K)):"—",B.monthlyIO.textContent=Q?e.format(Math.round(Q)):"—",B.lvr.textContent=F>0?t(U.lvr):"—",B.lmi.textContent=V>0?e.format(Math.round(V)):"—",B.stampDuty.textContent=J>0?e.format(Math.round(J)):"—",r=h.bp,n={incomeInput:a.value,expensesInput:i.value,dependants:x.value,otherDebts:I.value,rate:_.value,term:E.value,propertyPrice:L.value,deposit:A.value,state:T.value,capitaliseLMI:P.checked},(f=q)&&f.checked&&localStorage.setItem(r,JSON.stringify(n))}r.addEventListener("input",j),k?.addEventListener("click",j),j()}function b(){return new Promise((e,t)=>{if(window.Chart){e();return}let r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/chart.js",r.defer=!0,r.onload=()=>e(),r.onerror=t,document.head.appendChild(r)})}async function I(){let t=document.querySelector("#repay-form");if(!t)return;let r=document.querySelector("#loanAmountInput"),n=document.querySelector("#rRateInput"),a=document.querySelector("#rTerm"),o=document.querySelector("#frequency"),u=document.querySelector("#loanType"),i=document.querySelector("#ioYears"),s=document.querySelector("#extraInput"),c=document.querySelector("#loanAmountSlider"),$=document.querySelector("#rRateSlider"),d=document.querySelector("#rTermSlider"),m=document.querySelector("#ioYearsSlider"),p=document.querySelector("#extraSlider"),f=document.querySelector("#rememberRepay"),y=document.querySelector("#perRepay"),h=document.querySelector("#totalInterest"),x=document.querySelector("#totalPaid"),b=document.querySelector("#compare"),I=document.querySelector("#calcRepayBtn");!function(){a.innerHTML="";for(let e=1;e<=30;e++){let t=document.createElement("option");t.value=String(e),t.textContent=String(e),a.appendChild(t)}a.value="30",d&&(d.value="30")}(),v(c,r,0,2e6,1e3),v($,n,0,15,.01),v(p,s,0,5e3,50),v(m,i,0,5,1);let S=function(e,t){try{let r=localStorage.getItem(e);if(!r)return null;let n=JSON.parse(r);return t&&(t.checked=!0),n}catch{return null}}("hlm_rp_inputs",f);function _(){let t={amount:+r.value||0,annualRatePct:parseFloat(parseFloat(n.value).toFixed(2)),years:parseInt(a.value,10),frequency:o.value,type:u.value,ioYears:parseInt(i.value,10),extraPerPeriod:+s.value||0},c=l(t);y.textContent=c.perPayment?new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(Math.round(c.perPayment)):"—",h.textContent=e.format(Math.round(c.totalInterest)),x.textContent=e.format(Math.round(c.totalPaid));let $=l({...t,type:"pi",ioYears:0,extraPerPeriod:0}),d=l({...t,type:"io",ioYears:Math.min(t.ioYears,t.years),extraPerPeriod:0}),m=Math.round(d.totalInterest-$.totalInterest);b.textContent=(m>=0?"+":"")+e.format(Math.abs(m))+" interest vs P&I",f?.checked&&localStorage.setItem("hlm_rp_inputs",JSON.stringify({loanAmount:r.value,rRate:n.value,rTerm:a.value,frequency:o.value,loanType:u.value,ioYears:i.value,extra:s.value}))}S&&Object.entries(S).forEach(([e,t])=>{let r=document.querySelector("#"+e);r&&(r.value=t)}),t.addEventListener("input",_),I?.addEventListener("click",_),_()}window.addEventListener("DOMContentLoaded",()=>{x(),I(),function e(){let t=document.getElementById("menuToggle"),r=document.getElementById("primaryNav"),n=document.getElementById("backdrop");if(!t||!r||!n)return;let a=()=>{r.setAttribute("data-open","true"),n.hidden=!1,n.setAttribute("data-open","true"),t.setAttribute("aria-expanded","true"),document.body.classList.add("no-scroll");let e=r.querySelector("a");e&&e.focus()},l=()=>{r.setAttribute("data-open","false"),n.removeAttribute("data-open"),t.setAttribute("aria-expanded","false"),document.body.classList.remove("no-scroll"),window.setTimeout(()=>{n.hidden=!0},200)};t.addEventListener("click",()=>{let e="true"===r.getAttribute("data-open");(e?l:a)()}),n.addEventListener("click",l),document.addEventListener("keydown",e=>{"Escape"===e.key&&(l(),t.focus())}),r.addEventListener("click",e=>{e.target.matches("a")&&l()});let o=window.matchMedia("(min-width: 768px)"),u=()=>{o.matches&&l()};o.addEventListener("change",u)}()}),window.HLM={pmt:r,amortize:l,calculateAnnualTax:o,minMonthlyExpenseFor:u,maxBorrowing:s,monthlyPI:c,monthlyIO:$,calcLVR:d,estimateLMI:m,getStampDuty:p,periodsPer:n}}();